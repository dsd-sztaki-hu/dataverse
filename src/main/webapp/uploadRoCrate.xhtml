<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:jsf="http://xmlns.jcp.org/jsf"
>

<f:metadata>
    <f:viewParam name="ownerId" value="#{roCrateUploadServiceBean.ownerId}" />
</f:metadata>

<h:head>
    <h2>RO-Crate upload</h2>
</h:head>

<ui:param name="maxFileUploadSize" value="#{systemConfig.getMaxFileUploadSizeInBytes()}"/>

<h:body>
    <ui:composition template="/dataverse_template.xhtml">
        <ui:define name="body">

            <!-- Upload -->
            <div class="panel-group" role="tablist" aria-multiselectable="true" id="fileUploadFragment">
                <div jsf:id="httpPanel" class="panel panel-default">
                    <div role="tab" id="headingHTTP" data-toggle="collapse" data-target="#panelCollapseHTTP" class="panel-heading text-info" aria-expanded="true" aria-controls="panelCollapseHTTP">
                        #{bundle['file.fromHTTP']} &#160;<span class="glyphicon glyphicon-chevron-up"/>
                    </div>
                    <div id="panelCollapseHTTP" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingHTTP">
                        <h:form id="uploadForm" method="post" enctype="multipart/form-data">
                            <script>
                                //<![CDATA[
                                function uploadWidgetDropMsg() {
                                    const fileUpload = $('div[id$="fileUpload"] div.ui-fileupload-content');
                                    if ($(fileUpload).children('#dragdropMsg').length === 0) {
                                        $(fileUpload).prepend('<div id="dragdropMsg">#{bundle['file.selectToAdd.dragdropMsg']}</div>');
                                    }
                                }

                                $(document).ready(function () {
                                    uploadWidgetDropMsg();
                                });
                                //]]>
                            </script>
                            <div class="panel-body" jsf:id="contentOfHttpPanel">
                                <p:messages id="messages" showDetail="true" closable="false">
                                    <p:autoUpdate />
                                </p:messages>
                                <p:fileUpload id="fileUpload"
                                              mode="advanced"
                                              auto="true"
                                              multiple="false"
                                              allowTypes="/(\.|\/)(zip)$/"
                                              label="#{bundle['file.selectToAddBtn']}"
                                              dragDropSupport="true"
                                              sizeLimit="#{maxFileUploadSize}"
                                              listener="#{roCrateUploadServiceBean.handleDnd}"
                                              invalidSizeMessage="#{bundle['file.edit.error.file_exceeds_limit']}"
                                />
                            </div>
                        </h:form>
                    </div>
                </div>
            </div>
            <!-- END: Upload -->

        </ui:define>


    </ui:composition>
</h:body>
</html>